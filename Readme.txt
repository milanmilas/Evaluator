Result of the expression evaluation is 275225993853 and type used is long.
BigInteger could be used, depending of the requirements.
There are still some side effects in one of the functions that should be fixed.

Problem looks like a programming language evaluation of expressions and compiling,
non elegant and more complex/powerfull souldution would be in usage of stacks and polish notation.
One of the problems with graph expressions is detection of loops as well.
